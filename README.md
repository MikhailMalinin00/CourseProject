# Курсовой проект на тему: "Проектирование и разработка информационной системы кинотеатра на языке C#" 

В настоящее время кинотеатры являются одними из самых популярных мест отдыха и развлечений. Для эффективной работы кинотеатру необходимо иметь автоматизированную систему управления, которая позволит автоматизировать основные бизнес-процессы, такие как формирование репертуара, продажа билетов, бронирование билетов, управление залами и персоналом.
В большинстве кинотеатров используются устаревшие системы автоматизации, которые не отвечают современным требованиям. Такие системы часто являются ненадежными, неудобными в использовании и не позволяют в полной мере реализовать все возможности автоматизации.
Целью курсового проекта является проектирование и разработка информационной системы кинотеатра, которая позволит автоматизировать основные бизнес-процессы и повысить эффективность работы кинотеатра.
Для достижения этой цели необходимо решить следующие задачи:
- провести анализ предметной области и выявить основные бизнес-процессы, которые необходимо автоматизировать;
- разработать концептуальную модель информационной системы;
- разработать архитектуру информационной системы;
- разработать программную реализацию информационной системы.

Объектом исследования является информационная система кинотеатра. Предметом исследования является проектирование и разработка информационной системы кинотеатра. Основное функциональное назначение информационной системы – упрощение взаимодействия зрителя и администратора. Благодаря разрабатываемому программному обеспечению клиенту не придется стоять в очереди за билетом, тратить время на изучение афиши и покупку билетов – это все можно будет сделать дома в приложении.
При разработке информационной системы кинотеатра будет использован теоретический метод исследования, основанный на анализе готовых прикладных решений для выбранной предметной области, а также моделирование собственной системы путем построения различных диаграмм и схем.
Автоматизация бизнес-процессов в кинотеатре позволит:
- повысить эффективность работы кинотеатра, за счет сокращения времени и затрат на выполнение операций, а также снижения вероятности ошибок;
- улучшить качество обслуживания клиентов, за счет повышения скорости и удобства покупки билетов, бронирования мест, а также предоставления информации о репертуаре и услугах кинотеатра;
- расширить возможности маркетинга и продвижения кинотеатра, за счет использования информационных систем для анализа данных о клиентах и формирования персонализированных предложений. 

В процессе разработки будет использоваться язык программирования C#, среда разработки Visual Studio, для работы с базой данных будет использоваться SQL Server, а также для взаимодействия приложения с базой данных будет использоваться технология Entity Framework.

## Постановка задачи

Программное средство должно обеспечивать возможность выполнения перечисленных ниже функций: 
- управление администратором базой данных;
- возможность пользователю зарегистрироваться или войти в существующую учетную запись;
- возможность авторизированным пользователям просмотра информации о фильмах, сеансах и заказа билетов;
- возможность просмотра личной страницы пользователя с отображением всех заказанных билетов;
- возможность оценки фильма после его просмотра;
- уведомление пользователя о заказе билета.
К основным входным данным программного обеспечения относятся:
- данные о пользователях системы;
- данные о фильмах и времени его выхода в прокат.
К основным выходным данным относятся:
- расписание фильмов;
- афиша фильмов, находящихся в прокате;
- билет зрителя в кинотеатр.
К функциональным требования информационной системы относятся:
- добавление, изменение, хранение, обработка и удаление сведений о фильмах и их расписании;
- сведения о фильмах, находящихся в прокате: название, режиссер, длительность, рейтинг, жанр;
- данные о продажах билетов на определенные сеансы и фильмы;
- просмотр афиши и доступных фильмов;
- проведение кассовых операций.
К эксплуатационным требованиям приложения относятся:
- многопользовательская архитектура ПО;
- процессор Intel Core i3 10110U 2 ГГц и выше;
- объем ОЗУ 8 Гб;
- совместимость с операционной системой Windows 8, Windows 8.1, Windows 10, Windows 11;
- наличие 4 Гб свободного места на жестком диске;
- хранение информации в серверной базе данных;
- защита данных с помощью хеширования;
- перехват возможных ошибок пользователей;
- наличие мыши (тачпада) и клавиатуры.

## Анализ требований и определение спецификаций программного обеспечения

Для разработки приложения кинотеатра необходимо построить три диаграммы: диаграмма сущность-связь (ER-диаграмма), диаграмма вариантов использования (Use Case Diagram) и диаграмма последовательности (Sequence Diagram). 

![Image alt](https://github.com/MikhailMalinin00/Images/blob/main/CourseProject1.png)

На данном рисунке представлена ER-диаграмма информационной системы. Данная ER-диаграмма отображает будущее строение базы данных разрабатываемого приложения. 

![Image alt](https://github.com/MikhailMalinin00/Images/blob/main/CourseProject2.png)

На данной диаграмме представлены различные варианты использования разрабатываемого программного обеспечения. Некоторые варианты использования, такие как «Поиск фильмов по критериям», «Доступные сеансы» и «Просмотр списка фильмов» доступны обоим пользователям. Однако, такие как варианты использования, как «Заказ билета» доступен лишь клиенту, а «Просмотр панели администратора» – только администратору.

![Image alt](https://github.com/MikhailMalinin00/Images/blob/main/CourseProject3.png)

На данной диаграмме представлена последовательность варианта использования приложения администратором во время просмотра панели администратора. 

## Разработка программного обеспечения 

Для создания пользовательского интерфейса используется технология Windows Presentation Foundation (WPF). WPF позволяет разрабатывать приложения, используя как разметку, так и код программной части, что привычно для разработчиков на ASP.NET. Разметка XAML обычно используется для определения внешнего вида приложения, а управляемые языки программирования (код программной части) — для реализации его поведения. Такое разделение внешнего вида и поведения имеет ряд преимуществ, таких как снижение затрат на разработку благодаря разделению кода разметки от кода, обуславливающего поведение, а также повышение эффективности разработки благодаря параллельной работе дизайнеров приложения с разработчиками, реализующими поведение приложения. 
При работе с базой данных была выбрана технология ADO.NET. ADO.NET — это набор классов, предоставляющих службы доступа к данным программистам, которые используют платформу .NET Framework. ADO.NET имеет богатый набор компонентов для создания распределенных приложений, совместно использующих данные. Это неотъемлемая часть платформы .NET Framework, которая предоставляет доступ к реляционным данным, XML-данным и данным приложений. ADO.NET удовлетворяет различные потребности разработчиков, включая создание клиентских приложений баз данных, а также бизнес-объектов среднего уровня, используемых приложениями, средствами, языками и браузерам. 
Необходимый функционал для авторизации и регистрации пользователей реализован в методах SignInButton_Click() и SignUpButton_Click(). При авторизации и регистрации пользователей для защиты личных данных применяется метод GetHash(), шифрующий пароли пользователей методом Sha1. Ниже представлен листинг данного метода.
```csharp
public static string GetHash(string password)
 {
     using (var hash = SHA1.Create())
     {
         return string.Concat(hash.ComputeHash(Encoding.UTF8.GetBytes(password)).Select(x => x.ToString("X2")));
     }
}
```
После успешной авторизации пользователь перенаправляется на страницу афиши, на которой представлены фильмы в прокате, а также возможность заказать билет на выбранный сеанс. Метод OrderSomeTickets_Click() реализует функцию заказа определенного количества билетов на выбранный сеанс. Ниже представлен листинг данного метода.
```csharp
private void orderSomeTickets_Click(object sender, RoutedEventArgs e)
{
    string text = selectCountOfSeats.Text;
    int countSeats = 0;
    var currentSchedule = _currentSchedule;
    var MovieSchedule = Entities.GetContext().Schedule.First(x => x.MovieID == _currentMovie.ID);
    int scheduleId = MovieSchedule.ID;
    try
    {
        countSeats = Convert.ToInt32(text);
        if (countSeats > Convert.ToInt32(aviableSeats.Text))
            MessageBox.Show("Вы не можете заказать больше доступного кол-ва мест.", "Ошибка!", MessageBoxButton.OK);
        else if (countSeats > 10)
            MessageBox.Show("Вы не можете заказать больше 10 мест.", "Ошибка!", MessageBoxButton.OK);
        else if (countSeats <= 0)
            MessageBox.Show("Вы не можете заказать меньше 0 мест.", "Ошибка!", MessageBoxButton.OK);
        else
        {
            try
            {
                Entities db = new Entities();
                Orders orderObject = new Orders()
                {
                    UserID = _currentUser.ID,
                    ScheduleID = _currentSchedule.ID,
                    NumberOfSeat=countSeats
                };
                db.Orders.Add(orderObject);
                db.SaveChanges();
                _currentSchedule.AvailableSeat -= countSeats;
                Entities.GetContext().SaveChanges();
                MessageBox.Show("Вы успешно заказали билет!", "Успешно!", MessageBoxButton.OK);
                this.Close();
            }
            catch
            {
                MessageBox.Show("Произошла ошибка при заказе билета. Повторите попытку позже.", "Ошибка!", MessageBoxButton.OK);
            }
        }
    }
    catch
    {
        MessageBox.Show("Пожалуйста, введите корректное значение.", "Ошибка!", MessageBoxButton.OK);
    }
}
```
После заказа фильма пользователь в личном кабинете может оценить просмотренный фильм. Данная функция реализована с помощью метода SetRating_Click(), в котором прописана логика вычисления рейтинга с учетом текущего рейтинга и новой оценки пользователя. Ниже представлен листинг данного метода.
```csharp
private void SetRating_Click(object sender, RoutedEventArgs e)
{
    int rate;
    var currentSchedule = Entities.GetContext().Schedule.Where(x => x.ID == _currentOrder.ScheduleID).FirstOrDefault();
    var currentMovie = Entities.GetContext().Movies.Where(x => x.ID == currentSchedule.MovieID).FirstOrDefault();
    int oldRate = Convert.ToInt32(currentMovie.Rating);
    try
    {
        if (!Int32.TryParse(inputRating.Text, out rate))
            MessageBox.Show("Введите корректное численное значение.", "Ошибка!", MessageBoxButton.OK);
        else if (rate <= 0)
            MessageBox.Show("Введите положительное значение.", "Ошибка!", MessageBoxButton.OK);
        else if (rate > 10)
            MessageBox.Show("Введите значение от 1 до 10.", "Ошибка!", MessageBoxButton.OK);
        else if (string.IsNullOrEmpty(inputRating.Text))
            MessageBox.Show("Пожалуйста, введите значение.", "Ошибка!", MessageBoxButton.OK);
        else
        {
            int newRate = (oldRate + rate) / 2;
            currentMovie.Rating = newRate;
            Entities.GetContext().SaveChanges();
            MessageBox.Show($"Вы успешно оценили фильм на {rate}!", "Успешно!", MessageBoxButton.OK);
            this.Close();
        }
    }
    catch
    {
        MessageBox.Show("Возникла ошибка. Повторите попытку позже", "Ошибка!", MessageBoxButton.OK);
    }
}
```
Все необходимые администратору методы инкапсулированы в классе AdminPanel(), в котором имеются методы для добавления фильма и расписания к ним, а также удаление фильмов.
Методы AddFilmButton_Click() и AddSchedule_Click() вызываются после нажатия кнопок «Добавить фильм» и «Добавить расписание» в окнах добавления фильма и расписания соответственно. Ниже представлены листинг метода AddFilmButton_Click().
```csharp
private void addFilmButton_Click(object sender, RoutedEventArgs e)
{
    StringBuilder errors = new StringBuilder();
    if (string.IsNullOrWhiteSpace(_currentMovie.Title)) errors.AppendLine("Укажите название фильма!");
    if (string.IsNullOrWhiteSpace(_currentMovie.Director)) errors.AppendLine("Укажите режиссера фильма!");
    if (_currentMovie.Director == null) errors.AppendLine("Выберите жанр фильма!");
    if (string.IsNullOrWhiteSpace(Convert.ToString(_currentMovie.Duration))) errors.AppendLine("Укажите длительность фильма!");
    if (string.IsNullOrWhiteSpace(Convert.ToString(_currentMovie.Rating))) errors.AppendLine("Укажите рейтинг фильма!");
    if(errors.Length > 0)
    {
        MessageBox.Show(errors.ToString());
        return;
    }
    if (_currentMovie.ID == 0)
    {
        if (_currentMovie.Photo == null)
            _currentMovie.Photo = null;
        Entities.GetContext().Movies.Add(_currentMovie);
    }
    try
    {
        Entities.GetContext().SaveChanges();
        MessageBox.Show("Данные успешно сохранены!");
        Close();

    }
    catch(Exception ex) { MessageBox.Show(ex.Message.ToString()); }
}
```
Ниже представлены листинг метода AddSchedule _Click().
```csharp
private void addSchedule_Click(object sender, RoutedEventArgs e)
{
    int seatsInt;
    var date = dateInput.Text;
    var time = timeInput.Text;
    Int32.TryParse(seatsInput.Text, out seatsInt);
    if (string.IsNullOrEmpty(date))
        MessageBox.Show("Введите дату!", "Ошибка", MessageBoxButton.OK);
    else if (string.IsNullOrEmpty(time))
        MessageBox.Show("Введите время!", "Ошибка", MessageBoxButton.OK);
    else if (string.IsNullOrEmpty(seatsInput.Text))
        MessageBox.Show("Введите кол-во мест!", "Ошибка", MessageBoxButton.OK);
    else
    {
        try { var dateTest = DateTime.ParseExact(date, "yyyy-MM-dd", CultureInfo.InvariantCulture); }
        catch { MessageBox.Show("Неккоректно введена дата.", "Ошибка!", MessageBoxButton.OK); }
        try { var timeTest = DateTime.ParseExact(time, "HH:mm", CultureInfo.InvariantCulture); }
        catch { MessageBox.Show("Неккоректно введено время.", "Ошибка!", MessageBoxButton.OK); }

        if (seatsInt > 50)
            MessageBox.Show("Слишком много мест.", "Ошибка", MessageBoxButton.OK);
        else if (seatsInt < 10)
            MessageBox.Show("Слишком мало мест.", "Ошибка", MessageBoxButton.OK);
        else if (!Int32.TryParse(seatsInput.Text, out seatsInt))
            MessageBox.Show("Введите корректное значение доступных мест.", "Ошибка", MessageBoxButton.OK);
        else
        {
            try
            {
                var s = string.Concat(date, " ", time);
                DateTime dt = DateTime.ParseExact(s, "yyyy-MM-dd HH:mm", CultureInfo.InvariantCulture);
                Entities db = new Entities();
                Schedule scheduleObject = new Schedule
                {
                    MovieID = _currentMovie.ID,
                    AvailableSeat = seatsInt,
                    DateTime= dt,
                };
                db.Schedule.Add(scheduleObject);
                db.SaveChanges();
                MessageBox.Show("Расписание успешно добавлено!", "Успешно!", MessageBoxButton.OK);
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message.ToString());
            }
        }
    }
}
```
## Заключение

В ходе выполнения курсового проекта было разработано программное средство «ПРЕМИУМ КИНО» на языка C# с использованием технологий Entity Framework Core, WPF. В результате исследования были проанализированы текущие бизнес-процессы кинотеатра, выявлены их недостатки и определены возможности автоматизации.

При разработке программного средства были выполнены все пункты из указанного списка предполагаемого основного функционала приложения, а именно:
- создана база данных;
- реализована возможность пользователю зарегистрироваться или войти в существующую учетную запись;
- реализована возможность авторизированным пользователям просмотра информации о фильмах, сеансах и заказа билетов;
- реализована возможность просмотра личной страницы пользователя с отображением всех заказанных билетов;
- реализована возможность оценки фильма после заказа билета.

В процессе разработки были созданы ER-диаграмма, диаграмма вариантов использования и диаграмма последовательности вариантов использования. Все вышеперечисленные диаграммы визуально отображали логику работы программы, а также помогали в дальнейшей реализации информационной системы.

Во время создания приложения были приобретены новые навыки работы с базами данных с помощью Microsoft SQL Server Management Studio, работа с данными из приложения Windows Presentation Foundation, а также программирования на языке C# и реализации пользовательского интерфейса с помощью языка разметки XAML в среде разработки Microsoft Visual Studio.

Разработанная система была протестирована и отлажена, а также задокументирована. Тестирование показало, что она работает корректно и выполняет все свои функции.

Разработка информационной системы кинотеатра является актуальной задачей, поскольку позволяет автоматизировать основные бизнес-процессы кинотеатра, повысить эффективность работы кинотеатра и улучшить качество обслуживания клиентов. 

В соответствии с полученным результатом работы программы можно сделать вывод, что разработанная программа работает верно, а требования технического задания выполнены в полном объеме.
